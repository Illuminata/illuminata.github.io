xml
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>d҉o҉o҉m҉</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body {
      width: 100%; height: 100%; background: #000; overflow: hidden;
      font-family: 'Courier New', monospace;
    }
    .ascii-container {
      position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
      background: #000; cursor: pointer;
    }
    .ascii-content {
      color: #00ff00; white-space: pre; font-family: inherit;
      font-size: clamp(6px, 1vmin, 12px);
      line-height: 1;
      width: 100%; height: 100%; display: block;
      opacity: 0; transition: opacity 0.2s ease;
      text-align: left;
      letter-spacing: 0;
      margin: 0; padding: 0;
      position: absolute; top: 0; left: 0;
    }
    .ascii-content.ready {
      opacity: 1;
    }
    .hidden-video { display: none; }
    @media (prefers-reduced-motion: reduce) {
      .ascii-content { transition: none; }
    }
  </style>
</head>
<body>
  <div class="ascii-container" id="asciiContainer">
    <div class="ascii-content" id="ascii"></div>
  </div>

  <script>
    // Create hidden video element for frame source
    const video = document.createElement('video');
    video.src = 'DSC07338_DxO-moshed-04-18-18-14-30-943.mp4';
    video.muted = true;
    video.playsInline = true;
    video.crossOrigin = 'anonymous';
    video.preload = 'auto';
    video.style.display = 'none';
    document.body.appendChild(video);

    const ascii = document.getElementById('ascii');
    const chars = ' .:-=+*#%@';

    // Ping-pong control
    let direction = 1;           // +1 forward, -1 backward
    const fps = 30;              // target frame rate
    let frameDuration = 0;       // computed after metadata load
    let lastTime = 0;

    // Compute grid dimensions
    function getDimensions() {
      const fontSize = parseFloat(getComputedStyle(ascii).fontSize) || 8;
      const charWidth = fontSize * 0.6;
      const charHeight = fontSize;
      const width = Math.ceil(window.innerWidth / charWidth);
      const height = Math.ceil(window.innerHeight / charHeight);
      return { width, height };
    }

    // Render current video frame as ASCII
    function renderASCII() {
      const dim = getDimensions();
      const canvas = document.createElement('canvas');
      canvas.width = dim.width;
      canvas.height = dim.height;
      const ctx = canvas.getContext('2d', { willReadFrequently: true });
      ctx.drawImage(video, 0, 0, dim.width, dim.height);
      const data = ctx.getImageData(0, 0, dim.width, dim.height).data;
      let out = '';
      for (let y = 0; y < dim.height; y++) {
        for (let x = 0; x < dim.width; x++) {
          const i = (y * dim.width + x) * 4;
          const gray = Math.round(0.299 * data[i] + 0.587 * data[i+1] + 0.114 * data[i+2]);
          const enhanced = Math.min(255, Math.max(0, (gray - 128) * 1.3 + 128));
          const idx = Math.floor((enhanced / 255) * (chars.length - 1));
          out += chars[idx] || ' ';
        }
        if (y < dim.height - 1) out += '\n';
      }
      ascii.textContent = out;
      ascii.classList.add('ready');
    }

    // Step through video frames manually for ping-pong
    function step(timestamp) {
      if (!lastTime) lastTime = timestamp;
      const delta = (timestamp - lastTime) / 1000;
      if (delta >= frameDuration) {
        let t = video.currentTime + direction * frameDuration;
        if (t >= video.duration) {
          t = video.duration;
          direction = -1;
        } else if (t <= 0) {
          t = 0;
          direction = 1;
        }
        video.currentTime = t;
        renderASCII();
        lastTime = timestamp;
      }
      requestAnimationFrame(step);
    }

    // Initialize on metadata load
    video.addEventListener('loadedmetadata', () => {
      frameDuration = 1 / fps;
      video.currentTime = 0;
      video.pause();
      requestAnimationFrame(step);
    });

    // Toggle play/pause on click
    let playing = true;
    const asciiContainer = document.getElementById('asciiContainer');
    asciiContainer.addEventListener('click', () => {
      playing = !playing;
      if (playing) {
        requestAnimationFrame(step);
        asciiContainer.style.opacity = '1';
      } else {
        asciiContainer.style.opacity = '0.7';
      }
    });

    // Re-render on resize
    window.addEventListener('resize', () => {
      if (playing) renderASCII();
    });

    // Start loading
    video.load();
  </script>
</body>
</html>